<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
	<title>Data Grid</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
	<meta name="description" content="HTML is the foundation of the World Wide Web, and it is still the most popular markup language in use today.">
	<meta name="view-transition" content="same-origin">
	<link rel="stylesheet" href="/base.css">
	<link rel="stylesheet" href="./../table/ui-table.css">
	<link rel="stylesheet" href="./../table-expand/ui-table-expand.css">
	<link rel="stylesheet" href="./data-grid.css">
	<style>
		/* Demo */
		data-grid b { font-weight: 500; }
		data-grid .c-gray { color: var(--GrayText); }
	</style>
</head>
<body>
	<h1>UI: Components</h1>

	<h2>Data Grid</h2>
	<data-grid
		i18n="./data/i18n.json"
		id="grid"
		itemsperpage="25"
		lang="da"
		page="0">
	</data-grid>
	<script type="module" src="index.js"></script>

	<script>
		const grid = document.getElementById('grid');
		grid.addEventListener('dg:loaded', () => {
			fetch(`./data/test0.json`)
				.then((response) => response.json())
				.then((result) => {
					grid.settings = {
						colWidths: [5, 10, 30, 7.5, 35, 12.5],
						debug: true,
						density: 'medium',
						externalNavigation: true,
						expandType: '--inline-end',
						exportCSV: false,
						exportJSON: false,
						pagination: true,
						printable: false,
						rows: false,
						searchable: true,
						selectable: true,
						stickyCols: [0, 1],
						textoptions: false,
						textwrap: false,

						thead: [
							{ field: 'id', label: 'ID', key: true, event: 'dg:details', eventData: { view: 'comics'},  classList: 'ui-link' },
							{ field: 'issue', type: 'number', classList: '--end' },
							{ field: 'price', type: 'number', classList: '--end' },
							{ field: 'artist', hidden: true, expand: true },
							{ field: 'sku', hidden: true, expand: true },
							{ field: 'type', hidden: true, expand: true },
							{ field: 'description', hidden: true, expand: true },
							{ field: 'vendor', hidden: true, expand: true },
							{ field: 'date', hidden: true, expand: true },
							{ field: 'delivery', hidden: true, expand: true },
						],
					};
					grid.setItemsPerPage(10);
					grid.setTotalItems(result.total);
					grid.data = result.data;
				});
		});

		grid.addEventListener('dg:requestpagechange', (event) => {
			const requestedPage = event.detail.page;
			const dataUrl = `./data/test${requestedPage}.json`;
			fetch(dataUrl)
				.then((response) => response.json())
				.then((result) => {
					grid.data = result.data;
					grid.state.pageItems = result.data.length;
					grid.setPage(requestedPage);
				})
				.catch(error => console.error(`Error fetching data for page ${requestedPage}:`, error));
		});

		grid.addEventListener('dg:details', (event) => {
			console.log(event.detail);
		});

		// if(requestedPage === 1) grid.settings = { stickyCols: [] };
		// if(requestedPage === 2) grid.settings = { stickyCols: [1, 3] };
	</script>

</body>
</html>