<!DOCTYPE html>
<html lang="en-US" dir="ltr">
	<head>
		<title>Mega Menu</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
		<meta name="description" content="Sun Phase">
		<meta name="view-transition" content="same-origin">

		<style>
			body {
				font-family: system-ui, sans-serif;
				margin: 0;
				padding: 0;
			}
			:root {
				container-type: inline-size;
				interpolate-size: allow-keywords;
			}

			main {
				background: hsl(200, 10%, 95%);
			}

			body {
				--layout-bleed-mw: 85ch;
				--layout-mi: 1rem;
				--mega-menu-mi: var(--layout-mi);
				--mega-menu-bleed-mw: var(--layout-bleed-mw);

				margin-inline: max(
					var(--layout-mi, 0),
					50cqw - var(--layout-bleed-mw, 100cqw) / 2
				);
			}


		/* === MEGA MENU COMPONENT === */
		@layer components.mega-menu {
			@scope (mega-menu) {
				--mega-menu-h: 3rem;

				* { box-sizing: border-box; }

				[data-menu="container"] {
					background: var(--mega-menu-container-bg, Canvas);
					height: 100svh;
					inset: 0 calc(100vw - var(--mega-menu-container-w, 80vw)) 0 0;
					position: fixed;
					transition: translate var(--mega-menu-container-trsdu, 0.2s)
						var(--mega-menu-container-trstf, cubic-bezier(0.4, 0, 0.2, 1));
					translate: -100vw 0;
					width: var(--mega-menu-container-w, 80vw);
				}

				[data-menu="header"] {
					align-items: var(--mega-menu-ai, center);
					background: var(--mega-menu-bg, ButtonFace);
					color: var(--mega-menu-c, ButtonText);
					display: flex;
					height: var(--mega-menu-h);
					justify-content: var(--mega-menu-jc, space-between);
					margin-inline: min(
						-1 * var(--mega-menu-mi, 0),
						var(--mega-menu-bleed-mw, 100vw) / 2 - 50vw
					);
					padding-inline: max(
						var(--mega-menu-mi, 0),
						calc((100vw - var(--mega-menu-bleed-mw, 100vw)) / 2)
					);
					position: relative;
					user-select: none;
				}

				:is(
					[data-menu='section'],
					[data-menu='topic']) summary {
					list-style: none;
				}

				[data-menu="skip"] {
					background: var(--mega-menu-skip-bg, CanvasText);
					color: var(--mega-menu-skip-c, Canvas);
					font-size: var(--mega-menu-skip-fs, small);
					position: absolute;
					top: calc(0px - var(--mega-menu-h));
					&:focus-visible {
						top: 0;
						z-index: 1;
					}
				}

				[data-menu='topic'] summary:focus-visible {
					background: var(--mega-menu-topic-bg--focus, Highlight);
					color: var(--mega-menu-topic-c--focus, HighlightText);
					outline: none;
				}

				&:has(#mega-menu-trigger:checked) [data-menu='container'] {
					translate: 0;
				}
			


						@media (min-width: 720px) {
							[data-menu='container'] { display: contents; }
							[data-menu='panel'] {
								background: ButtonFace;
								columns: var(--mega-menu-desktop-panel-colm, 2);
								inset: 100% auto auto 0;
								min-height: var(--mega-menu-desktop-panel-mih, initial);
								padding-block: var(--mega-menu-desktop-panel-pb, 1lh);
								padding-inline: max(
									var(--mega-menu-panel-pi, var(--mega-menu-mi, 0)),
									calc((100vw - var(--mega-menu-bleed-mw, 100vw)) / 2)
								);
								position: absolute;
								width: 100vw;
								details[data-menu='section']::details-content {
									content-visibility: visible;
								}
							}
							[data-menu='bar'] {
								column-gap: var(--mega-menu-nav-cg, 2ch);
								display: flex;
								flex-direction: row;
							}
							[data-menu="trigger"] { display: none; }
						}
				}
			}
		</style>
	</head>
	<body>
		<!-- https://www.w3.org/WAI/ARIA/apg/patterns/menubar/ -->

		<mega-menu>
			<a href="#main" data-menu="skip">Skip to main content</a>
			<header data-menu="header">
				<a href="/">BRAND</a>
				<label aria-label="Open menu" data-menu="trigger" for="mega-menu-trigger">
					<input type="checkbox" data-sr id="mega-menu-trigger">
					Menu
				</label>

				<div data-menu="container">
					<nav aria-label="Main navigation" data-menu="bar">
						<details data-menu="topic" name="main-menu">
							<summary>Products</summary>
							<div data-menu="panel">
								<details data-menu="section">
									<summary>Smartphones</summary>
									<div role="group">
										<a href="/products/smartphones/iphone">iPhone</a>
										<a href="/products/smartphones/android">Android</a>
										<a href="/products/smartphones/pixel">Google Pixel</a>
										<a href="/products/smartphones/samsung">Samsung Galaxy</a>
									</div>
								</details>

								<details data-menu="section">
									<summary>Laptops</summary>
									<div role="group">
										<a href="/products/laptops/macbook">MacBook</a>
										<a href="/products/laptops/surface">Surface</a>
										<a href="/products/laptops/thinkpad">ThinkPad</a>
										<a href="/products/laptops/chromebook">Chromebook</a>
									</div>
								</details>

								<details data-menu="section">
									<summary>Tablets</summary>
									<div role="group">
										<a href="/products/tablets/ipad">iPad</a>
										<a href="/products/tablets/surface-pro">Surface Pro</a>
										<a href="/products/tablets/galaxy-tab">Galaxy Tab</a>
									</div>
								</details>

								<details data-menu="section">
									<summary>Accessories</summary>
									<div role="group">
										<details data-menu="section">
											<summary>Audio</summary>
											<div role="group">
												<a href="/products/accessories/audio/headphones">Headphones</a>
												<a href="/products/accessories/audio/earbuds">Earbuds</a>
												<a href="/products/accessories/audio/speakers">Speakers</a>
											</div>
										</details>

										<details data-menu="section">
											<summary>Charging</summary>
											<div role="group">
												<a href="/products/accessories/charging/cables">Cables</a>
												<a href="/products/accessories/charging/wireless">Wireless Chargers</a>
												<a href="/products/accessories/charging/power-banks">Power Banks</a>
											</div>
										</details>

										<details data-menu="section">
											<summary>Cases & Protection</summary>
											<div role="group">
												<a href="/products/accessories/cases/phone-cases">Phone Cases</a>
												<a href="/products/accessories/cases/laptop-bags">Laptop Bags</a>
												<a href="/products/accessories/cases/screen-protectors">Screen Protectors</a>
											</div>
										</details>
									</div>
								</details>
							</div>
						</details>

						<details data-menu="topic" name="main-menu">
							<summary>Services</summary>
							<div data-menu="panel">
								<details data-menu="section">
									<summary>Support</summary>
									<div role="group">
										<a href="/services/support/technical">Technical Support</a>
										<a href="/services/support/warranty">Warranty</a>
										<a href="/services/support/repairs">Repairs</a>
									</div>
								</details>

								<details data-menu="section">
									<summary>Business</summary>
									<div role="group">
										<a href="/services/business/enterprise">Enterprise Solutions</a>
										<a href="/services/business/bulk-orders">Bulk Orders</a>
										<a href="/services/business/consultation">Consultation</a>
									</div>
								</details>
							</div>
						</details>

						<details data-menu="topic" name="main-menu">
							<summary>About</summary>
							<div data-menu="panel">
								<a href="/about/company">Company</a>
								<a href="/about/careers">Careers</a>
								<a href="/about/news">News</a>
								<a href="/about/contact">Contact</a>
							</div>
						</details>
					</nav>

					<nav data-menu="bar">
						<details
							data-menu="topic"
							name="main-menu"
						>
							<summary>Search</summary>
							<search data-menu="panel">
								<input type="text" placeholder="Search..." role="searchbox">
								<button type="submit">Search</button>
							</search>
						</details>
						<a href="">Help</a>
					</nav>
				</div>
			</header>
		</mega-menu>

		<!-- Main content -->

		<main>
			<h2>Welcome to Our Website</h2>
			<p>
				This is the main content area. Click on the menu items to explore more.
			</p>
		</main>

		<script>
			function setupMenuA11y(header, groupSel, panelSel, focusSel) {
				if (!header) return;
				let current = null;
				const clearAttrs = (el) => (
					el.removeAttribute('data-last-typed-char'),
					el.removeAttribute('data-last-typed-index')
				);
				const getElements = (panel) =>
					Array.from(panel.querySelectorAll(focusSel)).filter(
						(el) => el.offsetParent
					);
				const closePanel = (details = current) => {
					if (details) {
						details.open = false;
						details.querySelector('summary')?.focus();
					}
				};
				const focusInPanel = (panel, isLast = false) => {
					const elements = getElements(panel);
					if (elements.length) {
						const target = isLast ? elements[elements.length - 1] : elements[0];
						setTimeout(() => target.focus(), 10);
					}
				};

				const handleKey = (evt) => {
					if (!current?.open) return;
					const panel = current.querySelector(panelSel);
					if (!panel) return;

					const elements = getElements(panel);
					const len = elements.length;

					if (evt.key === 'Escape' || evt.key === 'Tab') {
						closePanel();
						if (evt.key === 'Escape') evt.preventDefault();
						return;
					} else if (
						(evt.key === 'ArrowLeft' || evt.key === 'ArrowRight') &&
						len
					) {
						evt.preventDefault();
						const idx = elements.indexOf(document.activeElement);
						const next =
							evt.key === 'ArrowRight'
								? (idx + 1) % len
								: (idx - 1 + len) % len;
						elements[next].focus();
					} else if ((evt.key === 'Home' || evt.key === 'End') && len) {
						evt.preventDefault();
						elements[evt.key === 'Home' ? 0 : len - 1].focus();
					} else if (
						/^[a-z0-9]$/i.test(evt.key) &&
						!evt.ctrlKey &&
						!evt.altKey &&
						!evt.metaKey
					) {
						evt.preventDefault();
						const char = evt.key.toLowerCase();
						const getText = (el) =>
							(
								el.getAttribute('aria-label') ||
								el.textContent ||
								el.innerText ||
								el.value ||
								el.placeholder ||
								''
							)
								.trim()
								.toLowerCase();
						const matches = elements.filter((el) =>
							getText(el).startsWith(char)
						);

						if (!matches.length) return;

						const { lastTypedChar: last, lastTypedIndex: lastIdx } =
							current.dataset;
						const nextIdx =
							last === char ? ((+lastIdx || 0) + 1) % matches.length : 0;

						matches[nextIdx].focus();
						current.dataset.lastTypedChar = char;
						current.dataset.lastTypedIndex = nextIdx;
					}
				};

				const handleClick = (evt) =>
					current && !header.contains(evt.target) && closePanel();

				const handleMenubarKey = (evt) => {
					if (evt.target.tagName !== 'SUMMARY' || !evt.target.closest(groupSel))
						return;
					if (evt.key === 'ArrowDown' || evt.key === 'ArrowUp') {
						evt.preventDefault();
						const details = evt.target.closest(groupSel);
						details.open = true;
						const panel = details.querySelector(panelSel);
						panel &&
							setTimeout(() => focusInPanel(panel, evt.key === 'ArrowUp'), 10);
					}
				};

				header.addEventListener('keydown', handleMenubarKey);

				header.addEventListener(
					'toggle',
					(evt) => {
						const details = evt.target;
						if (!details.matches(groupSel)) return;

						if (details.open) {
							header
								.querySelectorAll(groupSel)
								.forEach(
									(other) =>
										other !== details &&
										other.open &&
										((other.open = false), clearAttrs(other))
								);
							current = details;
							clearAttrs(current);
							document.addEventListener('keydown', handleKey, true);
							document.addEventListener('click', handleClick, true);

							const panel = details.querySelector(panelSel);
							panel && focusInPanel(panel);
						} else if (current === details) {
							document.removeEventListener('keydown', handleKey, true);
							document.removeEventListener('click', handleClick, true);
							clearAttrs(details);
							current = null;
						}
					},
					true
				);
			}

			document.addEventListener('DOMContentLoaded', () => {
				setupMenuA11y(
					document.querySelector('mega-menu'),
					'nav[data-menu="bar"] > details[data-menu="topic"]',
					'[data-menu="panel"]',
					'a[href]:not([disabled]), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'
				);
			});
		</script>
	</body>
</html>
